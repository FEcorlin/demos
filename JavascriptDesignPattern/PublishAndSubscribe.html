<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>发布订阅模式</title>
</head>
<body>
<script type="text/javascript">
    // 发布者对象
    function Publisher() {

    }
    // var nthUglyNumber = function(n) {
        // var index = 1,result,num=0,i;
        // while(num<n){
        //     i=index;
        //     while(i%2===0){
        //         i=i/2;
        //     }
        //     while(i%3===0){
        //         i=i/3;
        //     }
        //     while(i%5===0){
        //         i=i/5;
        //     }
        //     if(i===1){
        //         result = index;
        //         num++;
        //     }
        //     index++;
        // }
        // return result;
    // }
    var nthUglyNumber = function(n) {
        function getIndex(arr,num) { // 将一个数字按序插入一个数组
            var len = arr.length,splitIndex=Math.floor(len/2),res;
            if(len==0){
                return 0;
            }
            if(len===1){
                if(num>arr[splitIndex]){
                    return 1;
                }
                else if(num<arr[splitIndex]){
                    return -1;
                }
                else {
                    return 0;
                }
            }
            if(num<arr[splitIndex]){
                return splitIndex-getIndex(arr.slice(0,splitIndex-1),num);
            }
            else if(num == arr[splitIndex]){
                return splitIndex;
            }
            else {
                return splitIndex+getIndex(arr.slice(splitIndex,len+1),num);
            }
        }
        // n 每个数字的n次方, n-1次方乘以每个数字,排序
        var arr = [],i=1,nums=[1,2,3,5],len=1,res;
        while (true) {
            for(var j = 0;j<4;j++){
                res = Math.pow(nums[j],i);
                if(arr.indexOf(res)<0){
                    arr.splice(getIndex(arr,res),0,res);
                    len = arr.length;
                    console.log(arr);
                }
                for(var k = 0;k<4;k++){
                    if(k!=j){
                        res = Math.pow(nums[j],i-1)*nums[k];
                        if(arr.indexOf(res)<0) {
                            arr.splice(getIndex(arr, res), 0, res);
                            len = arr.length;
                            console.log(arr);
                        }
                    }
                }
            }
            if(len>2*n){
                return arr[n-1];
            }
            i++;
        }
    };
        var start = new Date().getTime() / 1000;
        console.log(nthUglyNumber(10));
        console.log(new Date().getTime() / 1000 - start);
</script>

</body>
</html>